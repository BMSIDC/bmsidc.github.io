(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{332:function(s,t,a){"use strict";a.r(t);var e=a(33),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"初始化linux数据盘（fdisk）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化linux数据盘（fdisk）"}},[s._v("#")]),s._v(" 初始化Linux数据盘（fdisk）")]),s._v(" "),a("p",[s._v("我们的服务器可能会随着业务量的不断增长造成磁盘空间不足的情况，在这个时候我们就需要增加磁盘空间，本章主要介绍Linux类系统创建磁盘分区和挂载分区。")]),s._v(" "),a("p",[s._v("本文以云服务器的操作系统为CentOS 7.6为例，教程适用于"),a("strong",[s._v("Linux 发行版")]),s._v("系列系统")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[a("strong",[s._v("MBR支持的磁盘最大容量为2 TB，GPT最大支持的磁盘容量为18 EB，因此当您初始化容量大于2 TB的磁盘时，分区形式请采用GPT。对于Linux操作系统而言，当磁盘分区形式选用GPT时，fdisk分区工具将无法使用，需要采用parted工具。")])])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[a("strong",[s._v("首次使用云磁盘时，如果您未参考本章节对磁盘执行初始化操作，主要包括创建分区和文件系统等操作，那么当后续扩容磁盘时，新增容量部分的磁盘可能无法正常使用。")])])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"fdisk工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fdisk工具"}},[s._v("#")]),s._v(" fdisk工具")]),s._v(" "),a("p",[s._v("fdisk命令用于观察硬盘实体使用情况，也可对硬盘分区。")]),s._v(" "),a("h3",{attrs:{id:"_1-查看新增数据盘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-查看新增数据盘"}},[s._v("#")]),s._v(" 1. 查看新增数据盘")]),s._v(" "),a("p",[a("code",[s._v("# fdisk -l")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# fdisk -l")]),s._v("\n\nDisk /dev/nvme1n1: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1073.7")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1073741824000")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097152000")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n\nDisk /dev/nvme0n1: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128.0")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128035676160")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("250069680")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nDisk label type: dos\nDisk identifier: 0x000daca7\n\n        Device Boot      Start         End      Blocks   Id  System\n/dev/nvme0n1p1   *        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2099199")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("  Linux\n/dev/nvme0n1p2         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2099200")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18876415")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8388608")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("82")]),s._v("  Linux swap / Solaris\n/dev/nvme0n1p3        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18876416")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("250068991")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("115596288")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("  Linux\n")])])]),a("p",[s._v("表示当前的云服务器有两块磁盘，“/dev/nvme0n1”是系统盘，“"),a("strong",[s._v("/dev/nvme1n1")]),s._v("”是新增数据盘。")]),s._v(" "),a("h3",{attrs:{id:"_2-进入fdisk分区工具，执行分区操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-进入fdisk分区工具，执行分区操作"}},[s._v("#")]),s._v(" 2. 进入fdisk分区工具，执行分区操作")]),s._v(" "),a("p",[a("strong",[s._v("fdisk 新增数据盘")]),a("br"),s._v("\n以新挂载的数据盘“/dev/nvme1n1”为例："),a("br"),s._v(" "),a("code",[s._v("# fdisk /dev/nvme1n1")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# fdisk /dev/nvme1n1")]),s._v("\nWelcome to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fdisk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("util-linux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.23")]),s._v(".2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n\nChanges will remain "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" memory only, "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("until")]),s._v(" you decide to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" them.\nBe careful before using the "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v(" command.\n\nDevice does not contain a recognized partition table\nBuilding a new DOS disklabel with disk identifier 0x5ab5340b.\n\nCommand "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n")])])]),a("h3",{attrs:{id:"_3-新建分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-新建分区"}},[s._v("#")]),s._v(" 3. 新建分区")]),s._v(" "),a("p",[s._v("输入"),a("kbd",[s._v("n")]),s._v("，按"),a("kbd",[s._v("Enter")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Command "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": n\nPartition type:\n   p   primary "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" primary, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" extended, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   e   extended\nSelect "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n")])])]),a("p",[s._v("表示磁盘有两种分区类型：\n“p”表示主分区，“e”表示扩展分区。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("磁盘使用MBR分区形式，最多可以创建4个主分区，或者3个主分区加1个扩展分区，扩展分区不可以直接使用，需要划分成若干个逻辑分区才可以使用。磁盘使用GPT分区形式时，没有主分区、扩展分区以及逻辑分区之分。")])]),s._v(" "),a("h3",{attrs:{id:"_4-创建一个主分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-创建一个主分区"}},[s._v("#")]),s._v(" 4. 创建一个主分区")]),s._v(" "),a("p",[s._v("以创建一个分区为例，输入"),a("kbd",[s._v("p")]),s._v("，按"),a("kbd",[s._v("Enter")]),s._v("。"),a("br"),s._v("\n“Partition number”表示主分区编号，可以选择1-4。建议按"),a("kbd",[s._v("Enter")]),s._v("，采用默认值。"),a("br"),s._v("\n“First sector”表示起始磁柱值，默认为2048。建议按"),a("kbd",[s._v("Enter")]),s._v("，采用默认值。"),a("br"),s._v("\n“Last sector”表示截止磁柱值，默认为最大分区。建议按"),a("kbd",[s._v("Enter")]),s._v("，采用默认值。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Command "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": n\nPartition type:\n   p   primary "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" primary, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" extended, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   e   extended\nSelect "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default p"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": p\nPartition number "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-4, default "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\nFirst sector "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("-2097151999, default "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\nUsing default value "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("\nLast sector, +sectors or +size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("K,M,G"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("-2097151999, default "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097151999")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\nUsing default value "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097151999")]),s._v("\nPartition "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" of "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" Linux and of size "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" GiB is "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v("\n\nCommand "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\n")])])]),a("p",[s._v("表示分区完成，即为数据盘新建了1个分区，大小为1000GB。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("系统会自动提示分区可用空间的起始磁柱值和截止磁柱值，可以在该区间内自定义划分多个分区，或者使用默认值。起始磁柱值必须小于分区的截止磁柱值。")])]),s._v(" "),a("h3",{attrs:{id:"_5-查看新建分区的详细信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-查看新建分区的详细信息"}},[s._v("#")]),s._v(" 5. 查看新建分区的详细信息")]),s._v(" "),a("p",[s._v("输入"),a("kbd",[s._v("p")]),s._v("，按"),a("kbd",[s._v("Enter")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Disk /dev/nvme1n1: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1073.7")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1073741824000")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097152000")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nDisk label type: dos\nDisk identifier: 0x5ab5340b\n\n        Device Boot      Start         End      Blocks   Id  System\n/dev/nvme1n1p1            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097151999")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048574976")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("  Linux\n")])])]),a("p",[s._v("表示新建分区“"),a("strong",[s._v("/dev/nvme1n1p1")]),s._v("”的详细信息。")]),s._v(" "),a("h3",{attrs:{id:"_6-将分区结果写入分区表中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-将分区结果写入分区表中"}},[s._v("#")]),s._v(" 6. 将分区结果写入分区表中")]),s._v(" "),a("p",[s._v("输入"),a("kbd",[s._v("w")]),s._v("，按"),a("kbd",[s._v("Enter")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Command "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": w\nThe partition table has been altered"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\nCalling ioctl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to re-read partition table.\nSyncing disks.\n")])])]),a("p",[s._v("表示分区创建完成。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[a("strong",[s._v("注： 如果之前分区操作有误，请输入“q”，则会退出fdisk分区工具，之前的分区结果将不会被保留。")])])]),s._v(" "),a("h3",{attrs:{id:"_7-执行命令，将新的分区表同步至操作系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-执行命令，将新的分区表同步至操作系统"}},[s._v("#")]),s._v(" 7. 执行命令，将新的分区表同步至操作系统")]),s._v(" "),a("p",[a("code",[s._v("# partprobe")])]),s._v(" "),a("h3",{attrs:{id:"_8-将新建分区文件系统设为系统所需格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-将新建分区文件系统设为系统所需格式"}},[s._v("#")]),s._v(" 8. 将新建分区文件系统设为系统所需格式")]),s._v(" "),a("p",[a("strong",[s._v("mkfs -t 文件系统格式 磁盘分区")]),a("br"),s._v("\n以设置文件系统为“xfs”为例："),a("br"),s._v(" "),a("code",[s._v("# mkfs -t xfs /dev/nvme1n1p1")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkfs -t xfs /dev/nvme1n1p1")]),s._v("\nmeta-data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/nvme1n1p1         "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("isize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("agcount")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("agsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535936")]),s._v(" blks\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sectsz")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("attr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("projid32bit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("crc")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("finobt")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sparse")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndata     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("262143744")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("imaxpct")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sunit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("swidth")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" blks\nnaming   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("              "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   ascii-ci"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ftype")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("internal log           "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127999")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sectsz")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sunit")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" blks, lazy-count"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nrealtime "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("none                   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("extsz")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rtextents")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),a("p",[s._v("格式化需要等待一段时间，请观察系统运行状态，不要退出。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("注：xfs与ext4的区别请自行查阅，不同文件系统支持的分区大小不同，请根据您的业务需求选择合适的文件系统。")])]),s._v(" "),a("h3",{attrs:{id:"_9-新建挂载目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-新建挂载目录"}},[s._v("#")]),s._v(" 9. 新建挂载目录")]),s._v(" "),a("p",[a("strong",[s._v("mkdir 挂载目录")]),a("br"),s._v("\n以新建挂载目录“/data”为例："),a("br"),s._v(" "),a("code",[s._v("# mkdir /data")])]),s._v(" "),a("p",[s._v("执行以下命令，将新建分区挂载到创建的目录下。"),a("br"),s._v(" "),a("strong",[s._v("mount 磁盘分区 挂载目录")]),a("br"),s._v("\n以挂载新建分区“/dev/nvme1n1p1”至“/data”为例："),a("br"),s._v(" "),a("code",[s._v("# mount /dev/nvme1n1p1 /data")])]),s._v(" "),a("p",[s._v("执行以下命令，查看挂载结果。"),a("br"),s._v(" "),a("code",[s._v("# df -TH")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir /data")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount /dev/nvme1n1p1 /data")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -TH")]),s._v("\nFilesystem     Type      Size  Used Avail Use% Mounted on\ndevtmpfs       devtmpfs  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs          tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs          tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".0M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs          tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/nvme0n1p3 xfs       119G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".4G  117G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("% /\n/dev/nvme0n1p1 xfs       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".1G  137M  927M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v("% /boot\ntmpfs          tmpfs     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /run/user/0\n/dev/nvme1n1p1 xfs       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".1T   34M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".1T   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /data\n")])])]),a("p",[s._v("表示新建分区“/dev/nvme1n1p1”已挂载至“/data”。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[a("strong",[s._v("说明： 云服务器重启后，挂载会失效。您可以修改“/etc/fstab”文件，将新建磁盘分区设置为开机自动挂载，请参见设置开机自动挂载磁盘分区。")])])]),s._v(" "),a("h2",{attrs:{id:"设置开机自动挂载磁盘分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置开机自动挂载磁盘分区"}},[s._v("#")]),s._v(" 设置开机自动挂载磁盘分区")]),s._v(" "),a("p",[s._v("设置云服务器系统启动时自动挂载磁盘分区，不能采用在“/etc/fstab”直接指定设备名（比如/dev/nvme1n1）的方法，因为云中设备的顺序编码在关闭或者开启云服务器过程中可能发生改变，例如/dev/nvme1n1可能会变成/dev/nvme2n1。推荐使用UUID来配置自动挂载磁盘分区。")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("UUID（universally unique identifier）是Linux系统为磁盘分区提供的唯一的标识字符串。")])]),s._v(" "),a("h3",{attrs:{id:"_1-查询磁盘分区的uuid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-查询磁盘分区的uuid"}},[s._v("#")]),s._v(" 1. 查询磁盘分区的UUID")]),s._v(" "),a("p",[a("strong",[s._v("blkid 磁盘分区")]),a("br"),s._v("\n以查询磁盘分区“/dev/nvme1n1p1”的UUID为例："),a("br"),s._v(" "),a("code",[s._v("# blkid /dev/nvme1n1p1")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# blkid /dev/nvme1n1p1")]),s._v("\n/dev/nvme1n1p1: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cac4af5a-f0f5-42a1-b3d2-99443453db20"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TYPE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xfs"')]),s._v("\n")])])]),a("p",[s._v("表示“/dev/nvme1n1p1”的UUID。")]),s._v(" "),a("h3",{attrs:{id:"_2-编辑-fstab-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-编辑-fstab-文件"}},[s._v("#")]),s._v(" 2. 编辑“fstab”文件")]),s._v(" "),a("p",[a("code",[s._v("# vi /etc/fstab")]),a("br"),s._v("\n按"),a("kbd",[s._v("i")]),s._v("，进入编辑模式。"),a("br"),s._v("\n将光标移至文件末尾，按"),a("kbd",[s._v("Enter")]),s._v("，添加如下内容。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/fstab")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Created by anaconda on Thu Sep 26 23:10:30 2019")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Accessible filesystems, by reference, are maintained under '/dev/disk'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("62fb63a5-5ac0-4d02-b027-b35613f6fd76 /                       xfs     defaults        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("f06f904c-8c5a-4274-9a58-736a1820ca4a /boot                   xfs     defaults        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dcb2917c-3ef8-4ea3-8fea-bcbf1a232fa3 swap                    swap    defaults        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cac4af5a-f0f5-42a1-b3d2-99443453db20 /data defaults "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),a("p",[s._v("按"),a("kbd",[s._v("Esc")]),s._v("后，输入"),a("code",[s._v(":wq")]),s._v("，按"),a("kbd",[s._v("Enter")]),s._v("。"),a("br"),s._v("\n保存设置并退出编辑器。")]),s._v(" "),a("blockquote",[a("p",[s._v("以内容上仅为示例，具体请以实际情况为准，参数说明如下："),a("br"),s._v("\n第一列为UUID，此处填写第1步查询到的磁盘分区的UUID。"),a("br"),s._v("\n第二列为磁盘分区的挂载目录，可以通过df -TH命令查询。"),a("br"),s._v("\n第三列为磁盘分区的文件系统格式， 可以通过df -TH命令查询。"),a("br"),s._v("\n第四列为磁盘分区的挂载选项，此处通常设置为defaults即可。"),a("br"),s._v("\n第五列为Linux dump备份选项。现在通常不使用dump备份，此处设置为0即可。"),a("br"),s._v("\n第六列为fsck选项，即开机时是否使用fsck检查磁盘。0表示不检验。")])]),s._v(" "),a("h3",{attrs:{id:"_3-验证自动挂载功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-验证自动挂载功能"}},[s._v("#")]),s._v(" 3. 验证自动挂载功能")]),s._v(" "),a("p",[s._v("执行如下命令，卸载已挂载的分区。"),a("br"),s._v(" "),a("strong",[s._v("umount 磁盘分区")]),a("br"),s._v(" "),a("code",[s._v("# umount /dev/nvme1n1p1")]),a("br"),s._v("\n执行如下命令，将“/etc/fstab”文件所有内容重新加载。"),a("br"),s._v(" "),a("code",[s._v("# mount -a")]),a("br"),s._v("\n执行如下命令，查询文件系统挂载信息。"),a("br"),s._v(" "),a("strong",[s._v("mount | grep 挂载目录")]),a("br"),s._v(" "),a("code",[s._v("mount | grep /data")]),a("br"),s._v("\n回显类似如下图所示，说明自动挂载功能生效：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount | grep /data")]),s._v("\n/dev/nvme1n1p1 on /data "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" xfs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw,relatime,attr2,inode64,noquota"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);
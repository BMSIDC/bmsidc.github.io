(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{335:function(s,a,t){"use strict";t.r(a);var e=t(33),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"初始化linux数据盘（parted）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始化linux数据盘（parted）"}},[s._v("#")]),s._v(" 初始化Linux数据盘（parted）")]),s._v(" "),t("p",[s._v("我们的服务器可能会随着业务量的不断增长造成磁盘空间不足的情况，在这个时候我们就需要增加磁盘空间，本章主要介绍Linux类系统创建磁盘分区和挂载分区。")]),s._v(" "),t("p",[s._v("本文以云服务器的操作系统为CentOS 7.6为例，教程适用于"),t("strong",[s._v("Linux 发行版")]),s._v("系列系统")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("MBR支持的磁盘最大容量为2 TB，GPT最大支持的磁盘容量为18 EB，因此当您初始化容量大于2 TB的磁盘时，分区形式请采用GPT。对于Linux操作系统而言，当磁盘分区形式选用GPT时，fdisk分区工具将无法使用，需要采用parted工具。*")])]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[t("strong",[s._v("首次使用云磁盘时，如果您未参考本章节对磁盘执行初始化操作，主要包括创建分区和文件系统等操作，那么当后续扩容磁盘时，新增容量部分的磁盘可能无法正常使用。")])])]),s._v(" "),t("hr"),s._v(" "),t("h2",{attrs:{id:"parted工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parted工具"}},[s._v("#")]),s._v(" parted工具")]),s._v(" "),t("p",[s._v("在磁盘大于2T的时候，parted分区更加的方便。")]),s._v(" "),t("h3",{attrs:{id:"_1-查看新增数据盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-查看新增数据盘"}},[s._v("#")]),s._v(" 1. 查看新增数据盘")]),s._v(" "),t("p",[t("code",[s._v("# parted -l")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# parted -l")]),s._v("\nModel: NVMe Device "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nvme"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nDisk /dev/nvme0n1: 128GB\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512B/512B\nPartition Table: msdos\nDisk Flags:\n\nNumber  Start   End     Size    Type     File system     Flags\n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      1049kB  1075MB  1074MB  primary  xfs             boot\n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("      1075MB  9665MB  8590MB  primary  linux-swap"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("v1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("      9665MB  128GB   118GB   primary  xfs\n\nError: /dev/nvme1n1: unrecognised disk label\nModel: NVMe Device "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nvme"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nDisk /dev/nvme1n1: 4398GB\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512B/512B\nPartition Table: unknown\nDisk Flags:\n")])])]),t("p",[s._v("表示当前的云服务器有两块磁盘，“/dev/nvme0n1”是系统盘，“"),t("strong",[s._v("/dev/nvme1n1")]),s._v("”是新增数据盘。")]),s._v(" "),t("h3",{attrs:{id:"_2-进入parted分区工具，执行分区操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-进入parted分区工具，执行分区操作"}},[s._v("#")]),s._v(" 2. 进入parted分区工具，执行分区操作")]),s._v(" "),t("p",[t("strong",[s._v("parted 新增数据盘")]),t("br"),s._v("\n以新挂载的数据盘“/dev/nvme1n1”为例："),t("br"),s._v(" "),t("code",[s._v("# parted /dev/nvme1n1")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# parted /dev/nvme1n1")]),s._v("\nGNU Parted "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.1")]),s._v("\nUsing /dev/nvme1n1\nWelcome to GNU Parted"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" Type "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'help'")]),s._v(" to view a list of commands.\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("h3",{attrs:{id:"_3-设置磁盘分区形式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-设置磁盘分区形式"}},[s._v("#")]),s._v(" 3. 设置磁盘分区形式")]),s._v(" "),t("p",[t("strong",[s._v("mklabel 磁盘分区方式")]),t("br"),s._v("\n磁盘分区形式有MBR和GPT两种，以GPT为例："),t("br"),s._v(" "),t("code",[s._v("mklabel gpt")]),t("br"),s._v("\n查看磁盘分区形式。"),t("br"),s._v("\n输入"),t("kbd",[s._v("p")]),s._v("，按"),t("kbd",[s._v("Enter")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" mklabel gpt\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" p\nModel: NVMe Device "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nvme"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nDisk /dev/nvme1n1: 4398GB\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512B/512B\nPartition Table: gpt\nDisk Flags:\n\nNumber  Start  End  Size  File system  Name  Flags\n")])])]),t("h3",{attrs:{id:"_4-创建分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-创建分区"}},[s._v("#")]),s._v(" 4. 创建分区")]),s._v(" "),t("p",[s._v("以为整个磁盘创建一个分区为例，输入"),t("code",[s._v("# mkpart opt 2048s 100%")]),s._v("，按"),t("kbd",[s._v("Enter")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" mkpart opt 2048s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parted"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" p\nModel: NVMe Device "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nvme"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nDisk /dev/nvme1n1: 4398GB\nSector size "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 512B/512B\nPartition Table: gpt\nDisk Flags:\n\nNumber  Start   End     Size    File system  Name  Flags\n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      1049kB  4398GB  4398GB               opt\n")])])]),t("p",[s._v("表示分区完成，即为数据盘新建了1个分区，大小为4398GB。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("“2048s”表示磁盘起始容量，“100%”表示磁盘截止容量，此处仅供参考，您可以根据业务需要自行规划磁盘分区数量及容量。")])]),s._v(" "),t("p",[s._v("输入"),t("kbd",[s._v("q")]),s._v("，按"),t("kbd",[s._v("Enter")]),s._v("，退出parted分区工具。")]),s._v(" "),t("h3",{attrs:{id:"_5-查看新建分区的详细信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-查看新建分区的详细信息"}},[s._v("#")]),s._v(" 5. 查看新建分区的详细信息")]),s._v(" "),t("p",[t("code",[s._v("# lsblk")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsblk")]),s._v("\nNAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT\nnvme0n1     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":0    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("119")]),s._v(".2G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk\n├─nvme0n1p1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":1    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     1G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part /boot\n├─nvme0n1p2 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":2    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     8G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SWAP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n└─nvme0n1p3 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":3    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("110")]),s._v(".2G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part /\nnvme1n1     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":4    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     4T  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" disk\n└─nvme1n1p1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("259")]),s._v(":5    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     4T  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" part\n\n")])])]),t("p",[s._v("表示新建分区“"),t("strong",[s._v("/dev/nvme1n1p1")]),s._v("”的详细信息。")]),s._v(" "),t("h3",{attrs:{id:"_6-将新建分区文件系统设为系统所需格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-将新建分区文件系统设为系统所需格式"}},[s._v("#")]),s._v(" 6. 将新建分区文件系统设为系统所需格式")]),s._v(" "),t("p",[t("strong",[s._v("mkfs -t 文件系统格式 磁盘分区")]),t("br"),s._v("\n以设置文件系统为“xfs”为例："),t("br"),s._v(" "),t("code",[s._v("# mkfs -t xfs /dev/nvme1n1p1")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkfs -t xfs /dev/nvme1n1p1")]),s._v("\nmeta-data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/nvme1n1p1         "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("isize")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("agcount")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("agsize")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("268435328")]),s._v(" blks\n         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sectsz")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("attr")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("projid32bit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("crc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("finobt")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sparse")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndata     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1073741312")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("imaxpct")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sunit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("swidth")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" blks\nnaming   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("              "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   ascii-ci"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ftype")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("internal log           "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("bsize")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("521728")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("                       "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sectsz")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sunit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" blks, lazy-count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nrealtime "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("none                   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("extsz")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rtextents")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("格式化需要等待一段时间，请观察系统运行状态，不要退出。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("注：xfs与ext4的区别请自行查阅，不同文件系统支持的分区大小不同，请根据您的业务需求选择合适的文件系统。")])]),s._v(" "),t("h3",{attrs:{id:"_7-新建挂载目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-新建挂载目录"}},[s._v("#")]),s._v(" 7. 新建挂载目录")]),s._v(" "),t("p",[t("strong",[s._v("mkdir 挂载目录")]),t("br"),s._v("\n以新建挂载目录“/data”为例："),t("br"),s._v(" "),t("code",[s._v("# mkdir /data")])]),s._v(" "),t("p",[s._v("执行以下命令，将新建分区挂载到创建的目录下。"),t("br"),s._v(" "),t("strong",[s._v("mount 磁盘分区 挂载目录")]),t("br"),s._v("\n以挂载新建分区“/dev/nvme1n1p1”至“/data”为例："),t("br"),s._v(" "),t("code",[s._v("# mount /dev/nvme1n1p1 /data")])]),s._v(" "),t("p",[s._v("执行以下命令，查看挂载结果。"),t("br"),s._v(" "),t("code",[s._v("# df -TH")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir /data")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount /dev/nvme1n1p1 /data")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -TH")]),s._v("\nFilesystem     Type      Size  Used Avail Use% Mounted on\ndevtmpfs       devtmpfs  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs          tmpfs     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs          tmpfs     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(".0M  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs          tmpfs     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".5G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/nvme0n1p3 xfs       119G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".3G  118G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("% /\n/dev/nvme0n1p1 xfs       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".1G  137M  927M  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v("% /boot\ntmpfs          tmpfs     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7G     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".7G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /run/user/0\n/dev/nvme1n1p1 xfs       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".4T   34M  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".4T   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /data\n")])])]),t("p",[s._v("表示新建分区“/dev/nvme1n1p1”已挂载至“/data”。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[t("strong",[s._v("说明： 云服务器重启后，挂载会失效。您可以修改“/etc/fstab”文件，将新建磁盘分区设置为开机自动挂载，请参见设置开机自动挂载磁盘分区。")])])]),s._v(" "),t("h2",{attrs:{id:"设置开机自动挂载磁盘分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置开机自动挂载磁盘分区"}},[s._v("#")]),s._v(" 设置开机自动挂载磁盘分区")]),s._v(" "),t("p",[s._v("设置云服务器系统启动时自动挂载磁盘分区，不能采用在“/etc/fstab”直接指定设备名（比如/dev/nvme1n1）的方法，因为云中设备的顺序编码在关闭或者开启云服务器过程中可能发生改变，例如/dev/nvme1n1可能会变成/dev/nvme2n1。推荐使用UUID来配置自动挂载磁盘分区。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),t("p",[s._v("UUID（universally unique identifier）是Linux系统为磁盘分区提供的唯一的标识字符串。")])]),s._v(" "),t("h3",{attrs:{id:"_1-查询磁盘分区的uuid"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-查询磁盘分区的uuid"}},[s._v("#")]),s._v(" 1. 查询磁盘分区的UUID")]),s._v(" "),t("p",[t("strong",[s._v("blkid 磁盘分区")]),t("br"),s._v("\n以查询磁盘分区“/dev/nvme1n1p1”的UUID为例："),t("br"),s._v(" "),t("code",[s._v("# blkid /dev/nvme1n1p1")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# blkid /dev/nvme1n1p1")]),s._v("\n/dev/nvme1n1p1: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cac4af5a-f0f5-42a1-b3d2-99443453db20"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TYPE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xfs"')]),s._v("\n")])])]),t("p",[s._v("表示“/dev/nvme1n1p1”的UUID。")]),s._v(" "),t("h3",{attrs:{id:"_2-编辑-fstab-文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-编辑-fstab-文件"}},[s._v("#")]),s._v(" 2. 编辑“fstab”文件")]),s._v(" "),t("p",[t("code",[s._v("# vi /etc/fstab")]),t("br"),s._v("\n按"),t("kbd",[s._v("i")]),s._v("，进入编辑模式。"),t("br"),s._v("\n将光标移至文件末尾，按"),t("kbd",[s._v("Enter")]),s._v("，添加如下内容。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/fstab")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Created by anaconda on Thu Sep 26 23:10:30 2019")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Accessible filesystems, by reference, are maintained under '/dev/disk'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("62fb63a5-5ac0-4d02-b027-b35613f6fd76 /                       xfs     defaults        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("f06f904c-8c5a-4274-9a58-736a1820ca4a /boot                   xfs     defaults        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dcb2917c-3ef8-4ea3-8fea-bcbf1a232fa3 swap                    swap    defaults        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cac4af5a-f0f5-42a1-b3d2-99443453db20 /data defaults "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("按"),t("kbd",[s._v("Esc")]),s._v("后，输入"),t("code",[s._v(":wq")]),s._v("，按"),t("kbd",[s._v("Enter")]),s._v("。"),t("br"),s._v("\n保存设置并退出编辑器。")]),s._v(" "),t("blockquote",[t("p",[s._v("以内容上仅为示例，具体请以实际情况为准，参数说明如下："),t("br"),s._v("\n第一列为UUID，此处填写第1步查询到的磁盘分区的UUID。"),t("br"),s._v("\n第二列为磁盘分区的挂载目录，可以通过df -TH命令查询。"),t("br"),s._v("\n第三列为磁盘分区的文件系统格式， 可以通过df -TH命令查询。"),t("br"),s._v("\n第四列为磁盘分区的挂载选项，此处通常设置为defaults即可。"),t("br"),s._v("\n第五列为Linux dump备份选项。现在通常不使用dump备份，此处设置为0即可。"),t("br"),s._v("\n第六列为fsck选项，即开机时是否使用fsck检查磁盘。0表示不检验。")])]),s._v(" "),t("h3",{attrs:{id:"_3-验证自动挂载功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-验证自动挂载功能"}},[s._v("#")]),s._v(" 3. 验证自动挂载功能")]),s._v(" "),t("p",[s._v("执行如下命令，卸载已挂载的分区。"),t("br"),s._v(" "),t("strong",[s._v("umount 磁盘分区")]),t("br"),s._v(" "),t("code",[s._v("# umount /dev/nvme1n1p1")]),t("br"),s._v("\n执行如下命令，将“/etc/fstab”文件所有内容重新加载。"),t("br"),s._v(" "),t("code",[s._v("# mount -a")]),t("br"),s._v("\n执行如下命令，查询文件系统挂载信息。"),t("br"),s._v(" "),t("strong",[s._v("mount | grep 挂载目录")]),t("br"),s._v(" "),t("code",[s._v("mount | grep /data")]),t("br"),s._v("\n回显类似如下图所示，说明自动挂载功能生效：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@BMSIDC ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount | grep /data")]),s._v("\n/dev/nvme1n1p1 on /data "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("type")]),s._v(" xfs "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw,relatime,attr2,inode64,noquota"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);